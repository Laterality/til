# 2023. 10. 29.

## Elasticsearch(7.10)

### 집계 - 버킷 집계

#### Date histogram 집계

##### 달력과 고정 주기

날짜 히스토그램 집계를 구성할 때는 두 가지 방법으로 주기(interval)를 지정할 수 있다. 달력 인식 시간 주기(calendar-aware time interval)와 고정 시간 주기이다.

달력 인식 주기는 일광 절약으로 하루의 길이가 바뀌는 것과, 월(month)마다 서로 다른 일수를 갖는 것, 특정 연도에 붙는 윤초를 이해한다.

반면에, 고정 주기는 항상 SI 단위를 곱하며 달력 컨텍스트에 따라 변하지 않는다.

> **조합된 `interval` 필드 폐기**
>
> 역사적으로 달력과 고정 주기 둘을 하나의 `interval` 필드에 구성하면 의미가 혼동된다. `1d`를 지정하면 달력 인식 시간으로 가정하는 반면, `2d`는 고정 시간으로 해석된다. "하루"의 고정 주기를 얻으려면 사용자는 다음으로 더 작은 단뤼를 지정해야 한다(이 경우 `24h`).
>
> 이렇게 조합되는 행동은 종종 사용자들에게 알려져 있지 않고, 심지어 알고 있다 하더라도 사용하기 어렵고 혼란스럽다.
>
> 이 동작은 새로 추가된 명시적인 두 필드 `calendar_interval`과 `fixed_interval` 덕에 폐기됐다.
>
> 달력 방식과 주기 방식 중 하나를 선택하도록 강제함으로써 주기의 의미가 사용자에게 명확하고 모호함을 없앴다. 이전 `interval` 필드는 추후 제거될 것이다.



