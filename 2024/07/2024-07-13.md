# 2024. 07. 13.

## OpenID Authentication 2.0 - Final

### 11. 어설션 검증

#### 11.3. 넌스(nonce) 검사

재시도(replay) 공격을 막기 위해 서명을 검사하는 에이전트는 긍정 어설션에 포함된 넌스 값을 계속 추적하고 같은 OP 엔드포인트 URL에 대해 같은 값을 두 번 이상 수락해서는 안된다.

* "check_authentication"을 사용중일 때, OP는 같은 "openid.response_nonce" 값을 가진 요청에 대해 두 번 이상 성공 응답을 발행**해선 안된다**.
* 신뢰 당사자가 어설션의 서명을 검사할 때, 신뢰 당사자는 같은 엔드포인트 URL로부터 같은 "openid.response_nonce" 값을 수락한 적이 없었는지 확인**하는 것이 좋다**.

타임스탬프를 사용해 공격을 방지하기 위해 넌스가 저장돼야 하는 시간을 제한하고 현재 시간으로부터 지나치게 지난 응답을 거부하는 데 사용할 **수 있다**. 수락할 수 있는 범위는 이 명세의 범위를 벗어난다. 범위가 클수록 더 긴 시간 동안의 넌스를 저장해야 한다. 더 짧은 범위는 시간 오차와 시간 오차와 트랜잭션 시간으로 인해 요청을 잘못 거부할 가능성을 높인다.

