# 2024. 08. 31.

## OpenID Connect Core 1.0

### 3. 인증

#### 3.1. 인가 코드 흐름을 사용한 인증

##### 3.1.3. 토큰 엔드포인트

###### 3.1.3.2. 토큰 요청 유효성 검사

인가 서버는 다음과 같이 토큰 요청의 유효성을 **검사해야 한다**:

* 클라이언트 크리덴셜을 발급했거나 [섹션 9][oidc-core-section-9]에 따라 다른 클라이언트 인증 수단을 사용하는 경우 클라이언트를 인증한다.
* 인가 코드가 인증된 클라이언트에게 발급됐는지 확인한다.
* 인가 코드가 유효한지 확인한다.
* 가능한 경우, 인가 코드가 이전에 사용된 적 없는지 검증한다.
* `redirect_uri` 파라미터가 값이 최초 인가 요청에 포함된 `redirect_uri` 파라미터 값과 같은지 확인한다. 단 하나의 등록된 `redirect_uri` 값이 있을 `redirect_uri` 파라미터 값이 존재하지 않으면 인가 서버는 (클라이언트가 파라미터를 가져야 하므로)오류를 **반환**하거나 (OAuth 2.0은 이 경우 파라미터 생략을 허용하므로)오류 없이 **진행할 수** 있다.
* 사용된 인가 코드가 OpenID Connect 인증 요청에 대한 응답으로 발급된 것인지 검증한다(그래야 토큰 엔드포인트에서 ID Token이 반환될 것이다).



[oidc-core-section-9]: https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication