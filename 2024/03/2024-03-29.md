# 2024. 03. 29.

## Elasticsearch(7.10)

### 집계 - 지표 집계

#### Stats 집계

집계 도큐먼트로부터 추출된 숫자 값들에 대한 통계를 계산하는 `multi-value` 지표 집계. 이 값들은 도큐먼트의 특정 숫자 필드에서 추출되거나 제공된 스크립트에 의해 생성된 숫자 필드가 될 수 있다.

반환되는 통계는 `min`, `max`, `sum`, `count`, `avg`로 구성된다.

학생들의 시험 점수(0에서 100 사이)를 나타내는 도큐먼트로 구성된 데이터가 있다고 하자

```http
POST /exams/_search?size=0
{
  "aggs": {
    "grades_stats": { "stats": { "field": "grade" } }
  }
}
```

위 집계는 모든 도큐먼트에 대한 점수 통계를 계산한다. 집계 유형은 `stats`이고 `field` 설정은 통계가 계산될 도큐먼트의 숫자 필드를 정의한다. 위 요청은 다음과 같이 반환된다:

```json
{
  ...

  "aggregations": {
    "grades_stats": {
      "count": 2,
      "min": 50.0,
      "max": 100.0,
      "avg": 75.0,
      "sum": 150.0
    }
  }
}
```

집계의 이름(위에서는 `gradles_stats`)이 반환된 응답에서 집계 결과를 조회할 수 있는 키로 제공된다.