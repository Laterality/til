# 2024. 02. 13.

## Elasticsearch(7.10)

### 집계 - 지표 집계

#### Cardinality 집계

##### 미리 계산된 해시

높은 카디널리티를 가진 문자열 필드에는 인덱스에 필드 값의 해시를 저장한 뒤 이 필드에 대해 카디널리티 집계를 실행하는 것이 더 빠를 수 있다. 이는 클라이언트 측으로부터 해시 값을 제공하거나 [`mapper-murmur3`][plugin-murmur3] 플러그인을 사용해 Elasticsearch가 해시 값을 계산하도록 할 수 있다.

> 해시를 미리 계산하는 것은 CPU와 메모리를 절약하므로 매우 크거나 카디널리티가 높은 필드에만 유용하다. 하지만 숫자 필드의 경우 해싱이 매우 빠르고 원본 값을 저장하는 것은 해시를 저장하는 것만큼 혹은 그보다 덜 메모리를 사용한다. 또한 카디널리티가 낮은 문자열 필드에는 세그먼트별로 유니크한 값마다 최대 한 번만 해시를 계산하도록 최적화돼있다.



[plugin-murmur3]: https://www.elastic.co/guide/en/elasticsearch/plugins/8.12/mapper-murmur3.html