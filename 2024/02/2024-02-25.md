# 2024. 02. 25.

## Elasticsearch(7.10)

### 집계 - 지표 집계

#### Max집계

집계되는 도큐먼트로부터 추출된 숫자 값들 사이에서 최댓값을 추적해 반환하는 `singl-value` 지표 집계. 이 값들은 도큐먼트의 특정 숫자 필드나 제공된 스크립트에서 생성된 값이 될 수 있다.

> `min`과 `max` 집계는 데이터의 `double` 표현으로 동작한다. 이로 인해 절댓값이 `2^53`보다 큰 long  값에 대해서는 결과가 부정확할 수 있다.

모든 도큐먼트 사이에서 최대 가격을 계산한다

```http
POST /sales/_search?size=0
{
  "aggs": {
    "max_price": { "max": { "field": "price" } }
  }
}
```

응답:

```json
{
  ...
  "aggregations": {
      "max_price": {
          "value": 200.0
      }
  }
}
```

볼 수 있듯 집계의 이름(위에서는 `max_price`)또한 반환된 결과에서 조회할 수 있게 키로 제공된다.

