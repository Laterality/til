# 2024. 12. 02.

## OpenID Connect Core 1.0

### 10. 서명과 암호화

#### 10.2. 암호화

##### 10.2.1. 비대칭 암호화 키 로테이션

암호화 키 로테이션은 암호화 당사자가 프로세스를 시작하므로 `kid`를 키가 바뀌어야 한다는 신호로 의존할 수 없기 때문에 필연적으로 서명 키와는 다른 프로세스를 사용한다. 암호화 당사자는 여전히 JWE 헤더의 `kid` 헤더를 사용해 복호화 당사자에게 복호화에 사용할 키를 알리지만, 암호화 당사자는 먼저 수신자의 `jwks_uri` 위치의 JWK 집합에서 가장 적절한 키를 선택해야 한다.

키 로테이션을 위해, 복호화 당사자는 새 키를 자신의 `jwks_uri` 위치에 게시하고 JWK 집합에서 퇴역한 키를 제거할 수 있다. 암호화 당사자가 안전하게 JWK 집합을 캐시하고 매 암호화 이벤트마다 도큐먼트를 조회할 필요가 없도록 `jwks_uri`는 응답에 [RFC 7234][rfc-7234]에 정의된대로 `max-age` 지시자를 가진 `Cache-Control` 헤더를 포함하는 것이 좋다. 복호화 당사자는 `jwks_uri`로 참조되는 JWK 집합에서 퇴역한 키를 제거하지만 내부적으로는 캐싱 기간에 따라 일정 기간동안 유지해 암호화 당사자가 새 키를 얻을 시간을 줌으로써 키 간의 전환이 부드럽게 이어지도록 **하는 것이 좋다**. 캐싱 기간은 [섹션 10.1.1][oidc-core-section-10-1-1]에 설명된 대로, 새 서명 키의 발급에 따라 조절한다.



[rfc-7234]: https://www.rfc-editor.org/rfc/rfc7234.html
[oidc-core-section-10-1-1]: https://openid.net/specs/openid-connect-core-1_0.html#RotateSigKeys