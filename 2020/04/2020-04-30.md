## 2020. 04. 30.

### OpenTracing - 스코프와 스레딩(1)

#### 소개

어떤 스레드가 주어지면 여기에는 주변 애플리케이션 코드가 처리한 작업에 대한 책임을 갖는 "활성(active)" 스팬이 있으며, `ActiveSpan`이라 불린다. OpenTracing API는 어떤 경우에도 한 스레드 내에는 오직 하나의 `span`이 활성화 되어 있어야 한다. 이는 `Scope`를 사용해 `Span`의 활성화와 비활성화 형식을 관리한다.

같은 스레드에 동반하는 다른 스팬들은 다음 조건 중 하나를 만족한다:

- Started
- Not finished
- Not “active”

예를 들어 스팬들이 다음과 같은 경우, 동일한 스레드에 여러 스팬이 존재할 수 있다:

- I/O 대기 중
- 자식 스팬에서 블로킹된 상태
- 임계 경로(ciritical path) 외에 있음

> 만일 개발자가 새로운 `Span`을 생성할 때 `Scope`가 존재하면 프로그래머가 `buildSpan()`에서  `ingnoreActiveSpan()`을 호출하거나 명시적으로 부모 컨텍스트를 지정하지 않는 한 부모처럼 행동할 것이다.

