## 2022. 02. 17.

#### Elasticsearch(7.10)

#### 인덱스 모듈 - 인덱스 정렬을 사용해 결합 속도 높이기

인덱스 정렬은 Lucene doc id(`_id`와 혼동하지 말 것)를 조직화하여 접속사(a AND b AND ...)를 더 효율적으로 만드는 데 유용할 수 있다. 더 효율적이기 위해서 접속사가 만일 하나라도 일치하지 않는 절이 있다면 전체 접속사가 일치하지 않는다는 점을 이용한다. 인덱스 정렬을 사용하여 일치하지 않는 도큐먼트를 함께 둠으로써 접속사에 일치하지 않는 doc ID의 범위를 효율적으로 건너뛰는 데 도움이 될 것이다.

이 트릭은 카디널리티가 낮은 필드로만 동작한다. 경험상(rule of thumb) 낮은 카디널리티를 가지면서 필터링에 빈번하게 사용되는 필드로 먼저 정렬하는 것이 좋다. 같은 절(cluase)에 일치하는 값들을 가까이에 함께 두는 것이 중요하기 때문에 정렬 순서(`asc` 혹은 `desc`)는 상관 없다.

예를 들어, 판매중인 자동차를 인덱싱한다면 연료 타입, 차체 타입, 제조사, 등록 연도와 마지막으로 주행 거리를 기준으로 정렬하는 것이 좋을 것이다.

