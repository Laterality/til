# 2022. 05. 26.

## Elasticsearch(7.10)

### 매핑 - 필드 데이터 타입

#### Version 필드 타입

`version` 필드 타입은 소프트웨어 버전 값을 처리하고 별도의 순서 규칙을 제공하기 위한 `keyword` 필드의 특수한 형태이다. 순서는 [Semantic Versioning][semantic-versioning]에서 설명하는 규칙을 따른다. 예를 들어 메이저, 마이너, 패치 버전 부분이 각각 숫자로 정렬(i.e. "2.1.0" < "2.4.1" < "2.11.2")되며 프리 릴리즈(pre-release) 버전은 릴리즈 버전보다 앞에 정렬(i.e. "1.0.0-alpha" < "1.0.0")된다.

다음과 같이 `version` 필드를 인덱스할 수 있다:

```http
PUT my-index-000001
{
  "mappings": {
    "properties": {
      "my_version": {
        "type": "version"
      }
    }
  }
}
```

이 필드는 보통 키워드 필드와 동일한 검색 기능을 제공한다. 예를 들어 `match`나 `term` 쿼리를 사용해 일치하는 것을 검색할 수 있고 접두어나 와일드카드 검색을 지원한다. 주된 이점은 Semver 순서를 고려한 `range` 쿼리로, 예를 들어 "1.0.0"과 "1.5.0" 사이의  `range` 쿼리는 "1.2.3"은 포함하지만 "1.11.2"는 포함하지 않을 것이다. 알파벳 순서로 인덱스하는 보통의 `keyword` 필드와 다르다는 점을 알아두라.

소프트웨어 버전은 [Semantic Versioning 규칙][semantic-versioning] 스키마와 순서 규칙을 따른다고 기대한다. 한가지 알아둬야 할 예외는 주 버전 식별자가 세 개보다 많거나 적은 것을 허용한다는 점이다(i.e. "1.2"나 "1.2.3.4"는 엄밀하게 Semver 규칙을 따르지는 않지만 유효한 것으로 본다). Semver 정의에서 유효하지 않은 버전 문자열(.e.g "1.2.alpha.4")도 인덱스하고 일치하는 것을 조회할 수 있으나, 일반적인 알파벳 순서로 유효한 버전들 *뒤*에 위치한다. 빈 문자열 ""은 유효하지 않은 것으로 보고 모든 유효한 버전들 뒤에, 다른 유효하지 않은 버전들 앞에 위치한다.



[semantic-versioning]: https://semver.org/