# 2026-01-10

## Envoy

### 요청의 생명주기

#### 네트워크 토폴로지

요청이 어떻게 (Envoy를 포함한)네트워크의 구성 요소를 따라 흐르는지는 네트워크의 토폴로지에 따라 다르다. Envoy는 다양한 네트워크 토폴로지에서 쓰일 수 있다. 아래에서는 내부 동작에 초점을 맞추지만 이 섹션에서는 Envoy가 어떻게 네트워크의 나머지 부분들과 관련 있는지 간략히 살펴본다.

Envoy는 로드 밸런싱, 라우팅, 관측성, 보안 및 서비스 디스커버리를 애플리케이션으로부터 분리하는 [서비스 메시][envoy-blog-service-mesh] 사이드카 프록시로 시작됐다. 서비스 메시 모델에서는 요청이 Envoy를 게이트웨이로 하여 네트워크를 따라 흐른다. 요청은 인그레스(ingress)나 이그레스(egress) 리스너 중 하나를 통해 Envoy에 도달한다:

- 인그레스 리스너는 서비스 메시의 다른 노드로부터 요청을 받아 로컬 애플리케이션으로 포워드한다. 로컬 애플리케이션으로부터의 응답은 Envoy를 통해 다운스트림으로 되돌아간다.
- 이그레스 리스너는 로컬 애플리케이션으로부터 요청을 받아 네트워크의 다른 노드로 포워드한다. 수신하는 노드는 일반적으로 실행중인 Envoy이며 자신의 인그레스 리스너를 통해 요청을 수락한다.

Envoy는 서비스 메시 외에도 다양한 구성으로 쓰인다. 예를 들어, 내부 로드 밸런서로 동작할 수도 있다. 혹은 네트워크 엣지에서 인그레스/이그레스 프록시로 동작할 수 있다.

실질적으로 이들의 하이브리드가 종종 쓰이는데, 여기서 Envoy는 서비스 메시 엣지에서의 로드 밸런서로 기능한다. 요청 경로는 여러 Envoy를 거칠 수 있다.

Envoy는 확장성과 안정성을 위해 요청이 엣지 Envoy를 먼저 통과하고 두 번째 Envoy를 통과하는 다중 티어 토폴로지로 구성될 수 있다.

위의 모든 경우에서 요청은 다운스트림으로부터 TCP, UDP, 또는 Unix 도메인 소켓을 통해 특정 Envoy에 도달한다. Envoy는 요청들을 TCP, UDP 또는 Unix 도메인 소켓을 통해 업스트림으로 포워드한다. 이후에서는 단일 Envoy 프록시에 초점을 맞춘다.

[envoy-blog-service-mesh]: https://blog.envoyproxy.io/service-mesh-data-plane-vs-control-plane-2774e720f7fc
