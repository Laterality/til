# 2025-09-25

## Envoy

### 아키텍처 개요

#### 관측성

##### 액세스 로그

###### 액세스 로그 싱크

Envoy는 플러그 가능한 액세스 로그 싱크를 지원한다. 현재 지원되는 싱크:

**파일**

* 비동기 I/O 플러싱 메커니즘을 사용해 메인 네트워크 스레드를 블로킹하지 않는다.
* 사진 정의된 필드와 임의의 HTTP 요청/응답 헤더를 통해 커스터마이즈 가능한 로그 형식을 제공한다.

**gRPC**

* 액세스 로그 메시지를 gRPC 액세스 로깅 서비스로 보내는 데 사용된다.

**Stdout**

* 비동기 I/O 플러싱 메커니즘을 사용해 메인 네트워크 스레드를 블로킹하지 않는다.
* 사정 정의된 필드와 임의의 HTTP 요청/응답 헤더를 통해 커스커마이즈 가능한 로그 형식을 제공한다.
* 프로세스의 표준 출력에 쓴다. 모든 플랫폼에서 지원된다.

**Stderr**

* 비동기 I/O 플러싱 메커니즘을 사용해 메인 네트워크 스레드를 블로킹하지 않는다.
* 사전 정의된 필드와 임의의 HTTP 요청/응답 헤더를 통해 커스터마이즈 가능한 로그 형식을 제공한다.
* 프로세스의 표준 오류에 쓴다. 모든 플랫폼에서 지원된다.

**Fluentd**

* [Fluentd 포워드 프로토콜 명세][fluentd-forward-protocol-specification]에 기술된 Fluented 포워드 프로토콜을 지원하는 업스트림 목적지로의 TCP 커넥션을 통해 액세스 로그를 보낸다.
* 보내진 데이터는 (플러싱 주기와 다른 구성 파라미터들에 따라)하나 이상의 액세스 로그 엔트리를 가질 수 있는 [Fluentd 포워드 모드 이벤트][fluentd-forward-protocol-specification-forward-mode]의 스트림이다.

[fluentd-forward-protocol-specification]: https://github.com/fluent/fluentd/wiki/Forward-Protocol-Specification-v1
[fluentd-forward-protocol-specification-forward-mode]: https://github.com/fluent/fluentd/wiki/Forward-Protocol-Specification-v1#forward-mode
