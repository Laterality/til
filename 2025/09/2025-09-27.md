# 2025-09-27

## Envoy

### 아키텍처 개요

#### 관측성

##### 트레이싱

###### 개요

분산 트레이싱은 개발자들이 거대한 서비스 지향 아키텍처에서 호출 흐름을 시각화할 수 있게 한다. 직렬화, 병려화, 지연의 원인을 이해하는 데 중요할 수 있다. Envoy는 시스템 간 트레이싱과 관련된 세 가지 기능을 지원한다:

* **요청 ID 생성**: Envoy는 필요한 경우 [x-request-id][config-http-http-connection-manager-http-header-manipulation-x-request-id] HTTP 헤더를 UUID로 채운다. 애플리케이션들은 x-request-id 헤더를 포워드해 단일화된 로깅뿐만 아니라 트레이싱도 가능하다. 이 동작은 확장을 사용한 [HTTP 커넥션 관리자][api-extensions-filters-http-connection-manager-request-id-extension] 별로 구성할 수 있다.
* **클라이언트 트레이스 ID 조인**: [x-client-trace-id][config-http-http-connection-manager-http-header-manipulation-x-client-trace-id] 헤더를 사용해 신뢰할 수 없는 요청 ID들을 신뢰할 수 있는 내부 [x-request-id][config-http-http-connection-manager-http-header-manipulation-x-request-id]로 조인할 수 있다.
* **외부 트레이스 서비스 통합**: Envoy는 플러그 가능한 외부 트레이스 시각화 제공자를 지원한다. 두 가지 서브그룹으로 나뉜다:
  * [Zipkin][zipkin], [Jaeger][jaeger], [Datadog][datadog], [SkyWalking][skywalking], [AWS X-Ray][aws-x-ray], [Fluentd][fluentd]와 같이 Envoy 코드 베이스의 일부인 외부 트레이서.
  * [Instana][instana]와 같은 서드 파티 플러그인으로 제공되는 외부 트레이서.

[config-http-http-connection-manager-http-header-manipulation-x-request-id]: https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_conn_man/headers#config-http-conn-man-headers-x-request-id
[api-extensions-filters-http-connection-manager-request-id-extension]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-request-id-extension
[config-http-http-connection-manager-http-header-manipulation-x-client-trace-id]: https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_conn_man/headers#config-http-conn-man-headers-x-client-trace-id
[zipkin]: https://zipkin.io/
[jaeger]: https://github.com/jaegertracing/
[datadog]: https://www.datadoghq.com/ko/
[skywalking]: https://skywalking.apache.org/
[aws-x-ray]: https://docs.aws.amazon.com/xray/latest/devguide/xray-gettingstarted.html
[fluentd]: https://www.fluentd.org/
[instana]: https://www.ibm.com/kr-ko/products/instana/supported-technologies
