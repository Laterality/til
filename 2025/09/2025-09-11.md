# 2025-09-11

## Envoy

### 아키텍처 개요

#### 업스트림 클러스터

##### 아웃라이어 감지

###### 감지 유형

Envoy는 다음 아웃라이어 감지 유형을 지원한다:

**성공률**

성공률 기반의 아웃라이어 감지는 클러스터의 모든 호스트로부터 성공률 데이터를 집계한다. 그 다음 주어진 주기에 통계적 아웃라이어 감지를 기반으로 호스트를 방출한다. 집계 주기 동안 호스트의 요청 볼륨이 [outlier_detection.success_rate_request_volume][api-clusters-outlier-detection-success-rate-request-volume] 값보다 작으면 이 호스트에 대한 아웃라이어 감지는 계산되지 않는다. 게다가, 필요한 최소한의 요청 볼륨의 호스트의 수가 [outlier_detection.success_rate_minimum_hosts][api-clusters-outlier-detection-success-rate-minimum-hosts] 값보다 작으면 클러스터에 대한 감지는 수행되지 않는다.

([outlier_detection.split_external_local_origin_errors][api-clusters-outlier-detection-split-external-local-origin-errors]가 *false*인)기본 구성 모드에서 이 감지 유형은 지역적으로 및 외부에서 유래한 모든 유형의 오류를 고려한다. [outlier_detection.enforcing_local_origin_success][api-clusters-outlier-detection-enforcing-local-origin-success-rate] 구성 항목은 무시된다.

([outlier_detection.split_external_local_origin_errors][api-clusters-outlier-detection-split-external-local-origin-errors]가 *true*인)스플릿 모드에서는 지역적으로 유래한 오류와 외부에서 유래한 (트랜잭션)오류가 별개로 카운트되고 취급된다. 대부분의 구성 항목, 즉 [outlier_detection.sucess_rate_minimum_hosts][api-clusters-outlier-detection-success-rate-minimum-hosts], [outlier_detection.success_rate_request_volume][api-clusters-outlier-detection-success-rate-request-volume], [outlier_detection_success_rate_stdev_factor][api-clusters-outlier-detection-success-rate-stdev-factor]는 두 오류 유형 모두에 적용되지만 [outlier_detection.enforcing_success_rate][api-clusters-outlier-detection-enforcing-success-rate]는 외부에서 유래한 오류에만 적용되며 [outlier_detection.enforcing_local_origin_success_rate][api-clusters-outlier-detection-enforcing-local-origin-success-rate]는 지역적으로 유래한 오류에만 적용된다.

[api-clusters-outlier-detection-success-rate-request-volume]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/cluster/v3/outlier_detection.proto#envoy-v3-api-field-config-cluster-v3-outlierdetection-success-rate-request-volume
[api-clusters-outlier-detection-success-rate-minimum-hosts]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/cluster/v3/outlier_detection.proto#envoy-v3-api-field-config-cluster-v3-outlierdetection-success-rate-minimum-hosts
[api-clusters-outlier-detection-split-external-local-origin-errors]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/cluster/v3/outlier_detection.proto#envoy-v3-api-field-config-cluster-v3-outlierdetection-split-external-local-origin-errors
[api-clusters-outlier-detection-enforcing-local-origin-success-rate]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/cluster/v3/outlier_detection.proto#envoy-v3-api-field-config-cluster-v3-outlierdetection-enforcing-local-origin-success-rate
[api-clusters-outlier-detection-success-rate-stdev-factor]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/cluster/v3/outlier_detection.proto#envoy-v3-api-field-config-cluster-v3-outlierdetection-success-rate-stdev-factor
[api-clusters-outlier-detection-enforcing-success-rate]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/cluster/v3/outlier_detection.proto#envoy-v3-api-field-config-cluster-v3-outlierdetection-enforcing-success-rate
