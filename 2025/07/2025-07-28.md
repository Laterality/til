# 2025-07-28

## Envoy

### 아키텍처 개요

#### 업스트림 클러스터

##### 헬스 체크

###### 클러스터 멤버 별 헬스 체크 구성

한 업스트림 클러스터에 대해 활성 헬스 체크가 구성된 경우, [ClusterLoadAssignment][api-extensions-endpoint-cluster-load-assignment]에 각각 정의된  [LocalityLbEndpoints][api-extensions-endpoint-locality-lb-endpoints]의 [LbEndpoint][api-extensions-endpoint-lb-endpoint]의 [Endpoint][api-extensions-endpoint-endpoint]에서 [HealthCheckConfig][api-extensions-endpoints-health-check-config]를 설정해 등록된 각 멤버에 대한 구체적인 추가 구성을 명시할 수 있다.

[헬스 체크 구성][api-extensions-endpoints-health-check-config]에 [클러스터 멤버][api-extensions-endpoint-lb-endpoint]의 대체 헬스 체크 [주소][api-extensions-endpoints-health-check-config-address]와 [포트][api-extensions-endpoints-health-check-config-port-value]를 명시하는 예시:

```yaml
load_assignment:
  endpoints:
  - lb_endpoints:
    - endpoint:
        health_check_config:
          port_value: 8080
          address:
            socket_address:
              address: 127.0.0.1
              port_value: 80
        address:
          socket_address:
            address: localhost
            port_value: 80
```

[api-extensions-endpoint-cluster-load-assignment]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/endpoint/v3/endpoint.proto#envoy-v3-api-msg-config-endpoint-v3-clusterloadassignment
[api-extensions-endpoint-locality-lb-endpoints]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/endpoint/v3/endpoint_components.proto#envoy-v3-api-msg-config-endpoint-v3-localitylbendpoints
[api-extensions-endpoint-lb-endpoint]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/endpoint/v3/endpoint_components.proto#envoy-v3-api-msg-config-endpoint-v3-lbendpoint
[api-extensions-endpoint-endpoint]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/endpoint/v3/endpoint_components.proto#envoy-v3-api-msg-config-endpoint-v3-endpoint
[api-extensions-endpoints-health-check-config]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/endpoint/v3/endpoint_components.proto#envoy-v3-api-msg-config-endpoint-v3-endpoint-healthcheckconfig
[api-extensions-endpoints-health-check-config-address]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/endpoint/v3/endpoint_components.proto#envoy-v3-api-field-config-endpoint-v3-endpoint-healthcheckconfig-address
[api-extensions-endpoints-health-check-config-port-value]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/endpoint/v3/endpoint_components.proto#envoy-v3-api-field-config-endpoint-v3-endpoint-healthcheckconfig-port-value