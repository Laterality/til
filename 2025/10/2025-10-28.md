# 2025-10-28

## Envoy

### 아키텍처 개요

#### 운영 및 구성

##### xDS 구성 API 개요

###### CDS

[클러스터 디스커버리 서비스 (CDS) API][config-upstream-clusters-cluster-manager-cluster-discovery-service] 계층은 Envoy가 라우팅 도중 업스트림 클러스터를 발견할 수 있는 메커니즘을 제공한다. Envoy는 API에 명시된대로 우아하게(gracefully) 클러스터를 추가, 갱신, 제거할 것이다. 이 API는 구현자에게 Envoy가 초기 구성 시점에 모든 업스트림 클러스터를 알 필요가 없는 토폴로지를 구축할 수 있게 한다. 대체로 (라우트 디스커버리 서비스 없는)CDS를 동반한 HTTP 라우팅 수행 중에는 구현자가 [HTTP 요청 헤더][api-http-route-management-route-action-cluster-header]에 명시된 클러스터로 요청을 포워드하는 라우터이 기능을 사용하게 될 것이다.

완전히 정적인 클러스터를 명시해 EDS 없이 CDS를 쓸 수는 있지만, 여전히 CDS를 통해 지정된 클러스터에 대해 EDS API를 사용하는 것을 권장한다. 내부적으로, 클러스터 정의가 갱신되면 작업이 우아하게 이뤄진다. 하지만 모든 기존 커넥션 풀은 드레인되고 다시 연결된다. EDS는 이 제한으로 고통받지 않는다. EDS를 통해 호스트가 추가 및 제거되면 클러스터의 기존 호스트는 영향을 받지 않는다.

[config-upstream-clusters-cluster-manager-cluster-discovery-service]: https://www.envoyproxy.io/docs/envoy/latest/configuration/upstream/cluster_manager/cds#config-cluster-manager-cds
[api-http-route-management-route-action-cluster-header]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-field-config-route-v3-routeaction-cluster-header
