# 2025-10-22

## Envoy

### 아키텍처 개요

#### 보안

##### 위협 모델

아래에서는 Envoy 운영자, 개발자와 보안 연구자들과 관련된 Envoy 위협 모델을 명확히 다룬다.  보안 릴리즈 프로세스는 https://github.com/envoyproxy/envoy/security/policy 에서 자세히 확인할 수 있다.

###### 기밀성, 무결성, 가용성

우리는 데이터 기밀성이나 무결성을 훼손시키는 취약점을 가장 최우선으로 고려한다. Dos와 리소스 고갈과 관련된 영역에서 특히 가용성 또한 특히 Envoy를 엣지 배포로 활용하는 Envoy 운영자들에게 중요한 보안 고려사항이다.

다음 기준을 충족하는 공개 사항에 대해서는 보안 릴리즈 프로세스를 가동한다:

* 데이터 기밀성 또는 무결성의 손실을 야기하는 모든 문제는 보안 릴리즈 프로세스를 작동시킨다.
* Query-of-Death (QoD)나 리소스 고갈과 같은 가용성 문제는 보안 필리즈 프로세스를 작동시키기 위해 다음 조건을 모두 충족해야 한다:
  * 경화된(hardened) 것으로 태그된 컴포넌트(경화된 컴포넌트 목록은 [코어와 확장][arch-security-threat-model-core-and-extension] 참고).
  * 문제를 나타내는 트래픽 유형(업스트림 또는 다운스트림)이 구성 요소의 경과 태그와 일치. I.e. "신뢰할 수 없는 다운스트림에 경화됨"으로 태그된 컴포넌트는 다운스트림 요청에 영향을 받는다.
  * 다음 추가 조건을 만족해야 하는 리소스 고갈 문제:
    * 기존 타임아웃에 포함되지 않거나 짧은 타임아웃을 적용하는 것이 실용적이며
      * 메모리 고갈을 포함해 메모리 부족 조건으로 요청 별 메모리 사용량이 구성된 헤더나 상위 워터마크 제한을 100배 이상 초과하는 경우. I.e. 10KiB 클라이언트 요청에 Envoy가 1MiB 바이트의 메모리를 사용하는 경우.
      * Envoy가 클라이언트와 비교해 100x 이상 비대칭적으로 CPU를 사용하는 경우.

CPU와 메모리 DoS에 대한 Envoy 가용성 스탠스는 특히 무차별 대입 공격에서 여전히 발전하고 있다. 우리는 클라우드 인프라스럭처의 일부로 배포되거나 봇넷을 사용하는 경우 (i.e. 증폭 계수가 100 미만인 공격)무차별 대입 공격이 발생할 가능성이 높다는 점을 인정한다. 우리는 계속해서 오버로드 관리자와 워터마크 개선과 같은 잘 알려진 리소스 문제들을 살펴볼 것이다. 기존 Envoy 배포에 리스크가 될 수 있는 무차별 대입 공격 발표에 대해서는 보안 프로세스를 작동시킬 것이다.

현재 Envoy의 기본 설정이 가용성 관점에서 안전한 것으로 보지는 않는다. 운영자들은 Envoy의 워터마크, 오버로드 관리자, 서킷 브레이커 및 다른 리소스 관련된 기능들을 명시적으로 [구성][config-config-best-practice-edge-proxy]해 강건한 가용성을 제공해야 한다. 안전한 기본값이 빠져있는 것과 관련된 보안 공개사항에 대해서는 아무런 행동도 취하지 않는다. 시간이 지나면서 안전을 기본으로 하는 구성으로 나아가도록 작업하겠지만 하위 호환성과 성능을 고려해 변경사항 폐기 정책을 따라야 할 수도 있다.

[arch-security-threat-model-core-and-extension]: https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/security/threat_model#core-and-extensions
[config-config-best-practice-edge-proxy]: https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge#best-practices-edge
