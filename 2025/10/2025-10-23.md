# 2025-10-23

## Envoy

### 아키텍처 개요

#### 보안

##### 위협 모델

###### 데이터와 컨트롤 플레인

우리는 아키텍처 관점에서 Envoy의 내부 영역을 반영해 위협 모델을 데이터와 컨트롤 플레인으로 나눈다. Envoy의 코어 컴포넌트는 신뢰할 수 없는 다운스트림과 업스트림 피어 양쪽에 대해 경화된(hardened) 것으로 간주한다. 따라서 리스크 평가에서 우리의 최우선 순위는 신뢰할 수 없는 다운스트림 클라이언트에 의해 제기되는 위협이다. 이는 Envoy를 엣지 서빙으로 사용하는 것과 Envoy를 신뢰할 수 없는 서비스와 함께 서비스 메시 배포에서 네트워킹 컴포넌트로 사용하는 것을 반영한다.

컨트롤 플레인 관리 서버는 일반적으로 신뢰된다. 결과적으로 xDS 전송 프로토콜에 대한 통신 수준 악용은 우려사항으로 고려하지 않는다. 하지만 xDS를 통해 Envoy에 전달되는 구성은 신뢰할 수 없는 소스로부터 유래할 수 있고 완전히 소독(sanitize)되지 않았을 수 있다. 이러한 예로는 Envoy에서 테넌트가 `RouteConfiguration`에 일치하는 정규 표현식을 지정할 수 있는 여러 테넌트를 호스트하는 서비스 오퍼레이터가 있다. 이 경우 Envoy가 악의적인 구성에 의해 제기되는 위협에 대해 회복성이 있다고 기대한다.

Query of Death로 이어지는 구성 옵션과 같이 컨트롤 플레인과 데이터 플레인 조율을 요구하는 문제의 경우 Envoy 보안 팀이 리스크를 재평가한다. 구성 옵션이 장기간 유지되고 이를 끄는 것과 그대로 두는 것 모두 리스크가 있다면 보안 팀은 주로 엠바고 하에 문제를 수정하는 쪽을 택한다. 기능이 새것이고 구성 변경이 항상 데이터 플레이 크래시를 유발한다면 신뢰하는 컨트롤 플레인이 차단해야 하고 수정할 문제로 분류될 수 있다. 오래 유지되는 설정의 유일한 변형 하나가 문제를 일으키는 것과 같이 더 미묘한 문제들의 경우 보안 팀은 멀티 테넌트 오퍼레이터가 수정돼야 할지 결정하는 것을 포함해 모든 사용자에게 리스크가 되는 공격이 있는지를 평가하려고 시도한다.

일반적으로 외부 인가, 크리덴셜 공급자, rate limit 서비스와 같이 요청 처리 도중의 측면 호출에 활용되는 서비스들은 신뢰한다고 가정한다. 여기에 해당하지 않는 경우 문서에 명확히 밝힐 것이다.
