# 2025-12-26

## Envoy

### 아키텍처 개요

#### 고급

##### 제네릭 일치

###### 리스너의 일치 필터 체인

Envoy 리스너는 [네트워크 입력][arch-advanced-generic-matching-network-input-functions]의 모음에 따라 필터 체인을 선택하기 위해 [일치 API][api-common-messages-xds-unified-matcher-api-matcher]를 구현한다. 일치는 커넥션 별로 한 번씩 이뤄진다. 필터 체인 일치자가 리스너에서 유일하게 갱신된 필드인 경우를 제외하면 연관된 명명된 필터 체인 구성이 변경되면 커넥션은 드레인된다.

일치자 API의 동작은 필터 체인의 이름에 해당하는 문자열 값이어야 한다. 주어진 이름의 필터 체인이 없으면 [기본 필터 체인][api-listeners-listener-configuration-listener-default-filter-chain]이 지정된 경우 사용되며 그 외에는 커넥션이 거부된다. 필터 체인 일치자는 리스너의 모든 필터 체인이 유니크하게 명명될 것을 요구한다.

일치자 API는 기존 필터 [filter_chain_match][api-listeners-listener-components-filter-chain-filter-chain-match] 필드를 대체한다. 일치자 API를 사용중일 때는 필터 체인 일치 필드는 무시되며 설정돼선 안된다.

[arch-advanced-generic-matching-network-input-functions]: https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/advanced/matching/matching_api#extension-category-envoy-matching-network-input
[api-common-messages-xds-unified-matcher-api-matcher]: https://www.envoyproxy.io/docs/envoy/latest/xds/type/matcher/v3/matcher.proto#envoy-v3-api-msg-xds-type-matcher-v3-matcher
[api-listeners-listener-configuration-listener-default-filter-chain]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/listener/v3/listener.proto#envoy-v3-api-field-config-listener-v3-listener-default-filter-chain
[api-listeners-listener-components-filter-chain-filter-chain-match]: https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/listener/v3/listener_components.proto#envoy-v3-api-field-config-listener-v3-filterchain-filter-chain-match
